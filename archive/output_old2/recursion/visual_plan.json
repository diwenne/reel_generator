{
  "manim_code": "def construct(self):\n    # HOOK -------------------------------------------------------------\n    title = Text(\"Recursion Visualized\", font_size=50)\n    title.to_edge(UP, buff=0.5)\n    self.play(Write(title), run_time=1.0)\n    self.wait(1.5)\n\n    subtitle = Text(\"Example: factorial(4)\", font_size=36, color=YELLOW)\n    subtitle.move_to(DOWN * 0.5)\n    self.play(Write(subtitle), run_time=1.0)\n    self.wait(1)\n\n    # Move subtitle down a bit to clear center\n    self.play(subtitle.animate.to_edge(DOWN, buff=0.7), run_time=0.8)\n\n    # BUILD: Show function as a visual rule ---------------------------------\n    # Left side: rule description\n    rule_title = Text(\"Recursive rule\", font_size=34, color=BLUE)\n    rule_title.move_to(LEFT * 4 + UP * 1.5)\n\n    rule_lines = VGroup(\n        Text(\"factorial(n) = n \u00d7 factorial(n - 1)\", font_size=28),\n        Text(\"base case: factorial(1) = 1\", font_size=28, color=GREEN),\n    )\n    rule_lines.arrange(DOWN, center=True, buff=0.4)\n    rule_lines.move_to(LEFT * 4 + DOWN * 0.3)\n\n    self.play(Write(rule_title), run_time=0.8)\n    self.play(Write(rule_lines), run_time=1.2)\n    self.wait(1)\n\n    # Right side: call stack area frame\n    stack_box = Rectangle(width=5.0, height=5.5, color=GREY)\n    stack_box.move_to(RIGHT * 3 + DOWN * 0.2)\n    stack_label = Text(\"Call stack\", font_size=30, color=GREY)\n    stack_label.move_to(RIGHT * 3 + UP * 3.4)\n\n    self.play(Create(stack_box), Write(stack_label), run_time=1.0)\n    self.wait(0.5)\n\n    action_label = Text(\"Calls go down...\", font_size=30, color=YELLOW)\n    action_label.to_corner(UR)\n    self.play(Write(action_label), run_time=0.8)\n\n    # BUILD: Visualize stack frames as boxes ------------------------------\n    # Positions inside stack box (from top to bottom)\n    base_x = 3\n    top_y = 2\n    frame_h = 1.0\n\n    def make_frame(n, level_index):\n        y = top_y - level_index * frame_h\n        frame = Rectangle(width=4.4, height=0.9, color=BLUE)\n        frame.move_to(RIGHT * base_x + UP * y)\n        txt = Text(f\"factorial({n})\", font_size=28, color=WHITE)\n        txt.move_to(frame.get_center())\n        return frame, txt\n\n    # Create frames for n=4,3,2,1\n    frames = []\n    labels = []\n    for i, n in enumerate([4, 3, 2, 1]):\n        f, t = make_frame(n, i)\n        frames.append(f)\n        labels.append(t)\n\n    # Animate pushing frames (recursive calls)\n    # factorial(4)\n    self.play(Create(frames[0]), Write(labels[0]), run_time=0.8)\n    self.wait(0.4)\n\n    arrow_down_1 = Arrow(\n        start=LEFT * 0.5 + UP * 1.0,\n        end=LEFT * 0.5 + DOWN * 0.2,\n        color=YELLOW,\n        buff=0\n    )\n    arrow_down_1.shift(RIGHT * 2)\n    self.play(GrowArrow(arrow_down_1), run_time=0.7)\n\n    # factorial(3)\n    self.play(Create(frames[1]), Write(labels[1]), run_time=0.8)\n    self.wait(0.3)\n\n    arrow_down_2 = arrow_down_1.copy()\n    arrow_down_2.shift(DOWN * 1.0)\n    self.play(GrowArrow(arrow_down_2), run_time=0.7)\n\n    # factorial(2)\n    self.play(Create(frames[2]), Write(labels[2]), run_time=0.8)\n    self.wait(0.3)\n\n    arrow_down_3 = arrow_down_2.copy()\n    arrow_down_3.shift(DOWN * 1.0)\n    self.play(GrowArrow(arrow_down_3), run_time=0.7)\n\n    # factorial(1)\n    self.play(Create(frames[3]), Write(labels[3]), run_time=0.8)\n    self.wait(0.5)\n\n    # REVEAL: Reach base case ---------------------------------------------\n    self.play(FadeOut(action_label, run_time=0.5))\n\n    base_highlight = Rectangle(\n        width=4.6,\n        height=1.0,\n        color=GREEN,\n        stroke_width=4,\n    )\n    base_highlight.move_to(frames[3].get_center())\n\n    base_text = Text(\"Base case: return 1\", font_size=30, color=GREEN)\n    base_text.to_edge(DOWN, buff=0.5)\n\n    self.play(Create(base_highlight), Write(base_text), run_time=1.0)\n    self.wait(1.5)\n\n    # Prepare label for return phase at corner\n    return_label = Text(\"...then values return back up\", font_size=30, color=YELLOW)\n    return_label.to_corner(UR)\n    self.play(Write(return_label), run_time=0.8)\n\n    # REVEAL: Unwinding with return values --------------------------------\n    self.play(FadeOut(base_text), run_time=0.5)\n\n    # Track result values visually next to each frame\n    result_labels = []\n\n    # For factorial(1) -> 1\n    res1 = Text(\"= 1\", font_size=26, color=GREEN)\n    res1.next_to(frames[3], RIGHT, buff=0.6)\n    self.play(Write(res1), run_time=0.8)\n    result_labels.append(res1)\n    self.wait(0.5)\n\n    # Pop frame for n=1\n    self.play(\n        FadeOut(frames[3]),\n        FadeOut(labels[3]),\n        res1.animate.shift(UP * 1.0),\n        run_time=0.8,\n    )\n\n    # factorial(2) = 2 \u00d7 1\n    step2 = Text(\"factorial(2) = 2 \u00d7 1 = 2\", font_size=28, color=GREEN)\n    step2.to_edge(DOWN, buff=0.6)\n\n    self.play(Write(step2), run_time=0.8)\n    self.wait(0.8)\n\n    res2 = Text(\"= 2\", font_size=26, color=GREEN)\n    res2.next_to(frames[2], RIGHT, buff=0.6)\n    self.play(Write(res2), run_time=0.7)\n    result_labels.append(res2)\n\n    self.play(\n        FadeOut(frames[2]),\n        FadeOut(labels[2]),\n        FadeOut(step2),\n        res2.animate.shift(UP * 1.0),\n        run_time=0.9,\n    )\n\n    # factorial(3) = 3 \u00d7 2\n    step3 = Text(\"factorial(3) = 3 \u00d7 2 = 6\", font_size=28, color=GREEN)\n    step3.to_edge(DOWN, buff=0.6)\n    self.play(Write(step3), run_time=0.8)\n    self.wait(0.8)\n\n    res3 = Text(\"= 6\", font_size=26, color=GREEN)\n    res3.next_to(frames[1], RIGHT, buff=0.6)\n    self.play(Write(res3), run_time=0.7)\n    result_labels.append(res3)\n\n    self.play(\n        FadeOut(frames[1]),\n        FadeOut(labels[1]),\n        FadeOut(step3),\n        res3.animate.shift(UP * 1.0),\n        run_time=0.9,\n    )\n\n    # factorial(4) = 4 \u00d7 6\n    step4 = Text(\"factorial(4) = 4 \u00d7 6 = 24\", font_size=30, color=GREEN)\n    step4.to_edge(DOWN, buff=0.6)\n    self.play(Write(step4), run_time=0.8)\n    self.wait(1.2)\n\n    res4 = Text(\"= 24\", font_size=28, color=GREEN)\n    res4.next_to(frames[0], RIGHT, buff=0.6)\n    self.play(Write(res4), run_time=0.7)\n    result_labels.append(res4)\n\n    # Pop the last frame\n    self.play(\n        FadeOut(frames[0]),\n        FadeOut(labels[0]),\n        run_time=0.8,\n    )\n    self.wait(0.5)\n\n    # REINFORCE: Show final answer clearly --------------------------------\n    final_answer = Text(\"factorial(4) = 24\", font_size=40, color=GREEN)\n    final_answer.move_to(ORIGIN + DOWN * 0.3)\n\n    # Fade out clutter on right, bring answer to center\n    self.play(\n        FadeOut(stack_box),\n        FadeOut(stack_label),\n        FadeOut(rule_title),\n        FadeOut(rule_lines),\n        FadeOut(arrow_down_1),\n        FadeOut(arrow_down_2),\n        FadeOut(arrow_down_3),\n        FadeOut(return_label),\n        FadeOut(subtitle),\n        *[FadeOut(r) for r in result_labels],\n        FadeOut(step4),\n        run_time=1.0,\n    )\n\n    self.play(Write(final_answer), run_time=1.0)\n    self.wait(2)\n\n    # CONCLUDE: Recursion summary -----------------------------------------\n    summary_lines = VGroup(\n        Text(\"Recursion:\", font_size=34, color=YELLOW),\n        Text(\"1. Break the problem into a smaller copy of itself\", font_size=28),\n        Text(\"2. Stop at a simple base case\", font_size=28),\n        Text(\"3. Let answers flow back up the call stack\", font_size=28),\n    )\n    summary_lines.arrange(DOWN, center=True, buff=0.3)\n    summary_lines.to_edge(DOWN, buff=0.7)\n\n    self.play(Write(summary_lines), run_time=1.5)\n    self.wait(2.5)\n\n    self.play(\n        FadeOut(final_answer),\n        FadeOut(summary_lines),\n        FadeOut(title),\n        run_time=1.0,\n    )\n    self.wait(1)",
  "estimated_duration": 50
}